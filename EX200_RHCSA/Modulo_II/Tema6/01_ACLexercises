EJERCICIO A DESARROLLAR EN serverX

0. Está el fichero /etc/shadow esta en un sistema de archivos montado con soporte acl?
Hint: para saber en que FS está /etc/shadow usar el comando df

	df /etc/shadow  --> nos dice que está en /dev/vda1
	blkid /dev/vda1 nos dice que es xfs

	xfs tiene por defecto activadas las ACLs

1. Hacer una copia del /etc/shadow en /home

	su -
	cp /etc/shadow /home

2. Permitir al usuario foobar leer y escribir, el file /home/shadow.

	su -
	useradd foobar
	setfacl -m u:foobar:rw- /home/shadow

3. Dar una máscara al file /home/shadow que permita leer y no escribir al grupo, usuarios con nombre y grupos con nombre.

	setfacl -m m::r-- /home/shadow ó chmod g-wx /home/shadow ó chmod g=r /home/shadow

4.  Si la máscara permite solo leer que permisos efectivos tendrá foobar?
	
	r--

5. Crear el usuario usera con  password usera, y copiar en su home el file /bin/false.

	useradd usera
	passwd usera
	cp /bin/false /home/usera


6. usera tiene que pertenecer al grupo root.

	usermod -aG root usera

7. root tiene que ser el propietario del file /bin/false que ha sido copiado en la home de usera, darle el SUID a la copia del file.
	
	chown u+s /home/usera/false

8. Añadir el usuario foobar al grupo gruppo

	groupadd gruppo
	usermod -aG gruppo foobar

9. Permitir a los usuarios que pertenecen al grupo propietario del file /home/usera/false y al grupo gruppo, leer, escribir y ejecutar el file. Impedir cualquier tipo de acceso a los demás usuarios.

	chmod 770 /home/usera/false
	setfacl -m g::rwx /home/usera
	setfacl -m g:root:rx /home/usera
	setfacl -m g:gruppo:rx /home/usera
	setfacl -m g:gruppo:rwx /home/usera/false
	

10. Crear el directorio /datti.

	mkdir /datti

11. Crear un directorio llamado colabora en /datti. Este directorio tiene que ser colaborativo para el grupo grupppo al cual pertenecen foobar y usera, solo los del grupo propietario podrán leer, modificar y acceder a este directorio.

	grpadd grupppo	
	mkdir /datti/colabora
	usermod -aG grupppo foobar
	usermod -aG grupppo usera
	chgrp grupppo /datti/colabora
	chmod 2770 /datti/colabora ó chmod g+ws,o-rx /datti/colabora ó chmod g+ws,o= /datti/colabora

12. El usuario mick necesitará también colaborar con el grupo grupppo, pero solo dándole acceso y permiso de listar lo que hay en el directorio, pero además mick podrá leer los nuevos files creados dentro. 
	
	useradd mick; echo mick |passwd --stdin mick
	setfacl -m u:mick:rX /datti/colabora
	setfacl -Rm d:u:mick:rX /datti/colabora

